"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["1865"],{6772:function(e,i,n){n.r(i),n.d(i,{default:()=>h,frontMatter:()=>l,metadata:()=>s,assets:()=>a,toc:()=>c,contentTitle:()=>d});var s=JSON.parse('{"id":"user_guide/fitting/method_files","title":"Method Files","description":"Overview","source":"@site/docs/user_guide/fitting/method_files.md","sourceDirName":"user_guide/fitting","slug":"/user_guide/fitting/method_files","permalink":"/ChemEx/docs/user_guide/fitting/method_files","draft":false,"unlisted":false,"editUrl":"https://github.com/gbouvignies/chemex/tree/main/website/docs/user_guide/fitting/method_files.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Parameter Files","permalink":"/ChemEx/docs/user_guide/fitting/parameter_files"},"next":{"title":"Kinetic Models","permalink":"/ChemEx/docs/user_guide/fitting/kinetic_models"}}'),t=n("5893"),r=n("65");let l={sidebar_position:6},d="Method Files",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Example Method File",id:"example-method-file",level:2},{value:"Setting Parameter Behavior",id:"setting-parameter-behavior",level:2},{value:"<code>FIT</code>",id:"fit",level:3},{value:"<code>FIX</code>",id:"fix",level:3},{value:"<code>CONSTRAINTS</code>",id:"constraints",level:3},{value:"Selecting a Subset of Profiles",id:"selecting-a-subset-of-profiles",level:2},{value:"<code>INCLUDE</code>",id:"include",level:3},{value:"<code>EXCLUDE</code>",id:"exclude",level:3},{value:"Running a Grid Search",id:"running-a-grid-search",level:2},{value:"Estimating Parameter Uncertainty",id:"estimating-parameter-uncertainty",level:2},{value:"Monte Carlo Simulations",id:"monte-carlo-simulations",level:3},{value:"Bootstrap Analysis",id:"bootstrap-analysis",level:3},{value:"Nucleus-Specific Bootstrap Analysis",id:"nucleus-specific-bootstrap-analysis",level:3},{value:"Syntax",id:"syntax",level:3}];function o(e){let i={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"method-files",children:"Method Files"})}),"\n",(0,t.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(i.p,{children:"Method files define the fitting methods used in ChemEx. In these files, you can:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Specify which parameters to fit, fix, or constrain."}),"\n",(0,t.jsx)(i.li,{children:"Select the profiles to include in calculations."}),"\n",(0,t.jsx)(i.li,{children:"Activate additional analyses, such as grid search, Monte Carlo, or bootstrap analyses."}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["Provide the method file to ChemEx using the ",(0,t.jsx)(i.code,{children:"-m"})," or ",(0,t.jsx)(i.code,{children:"--method"})," option."]}),"\n",(0,t.jsx)(i.p,{children:"Method files are structured in sections, each representing a fitting step. Fitting steps are executed in the order they appear, and parameter settings inherit from previous steps if not redefined."}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["When performing multi-step fitting, start with a subset of residues with high-quality data (e.g., large CPMG dispersion or clear CEST dips) to estimate global parameters, then fix these parameters in subsequent steps to fit residue-specific parameters. For example, see the method file for ",(0,t.jsx)(i.code,{children:"CPMG_CH3_1H_SQ/"})," in ",(0,t.jsx)(i.code,{children:"Examples/Experiments/"}),"."]})}),"\n",(0,t.jsx)(i.h2,{id:"example-method-file",children:"Example Method File"}),"\n",(0,t.jsx)(i.p,{children:"An example method file with four fitting steps is shown below:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",metastring:'title="method.toml"',children:'[STEP1]\nINCLUDE = [15, 31, 33, 34, 37]\nGRID    = [\n    "[KEX_AB] = log(100.0, 600.0, 10)",\n    "[PB] = log(0.03, 0.15, 10)",\n    "[DW_AB] = lin(0.0, 10.0, 5)",\n]\n\n[STEP2]\nFIT = ["PB", "KEX_AB", "DW_AB"]\nSTATISTICS = { "MC"=100, "BS"=100, "BSN"=100 }\n\n[STEP3]\nINCLUDE = "ALL"\nFIX     = ["PB", "KEX_AB"]\nGRID    = ["[DW_AB] = lin(0.0, 10.0, 20)"]\n\n[STEP4]\nFIT = ["DW_AB"]\n'})}),"\n",(0,t.jsx)(i.p,{children:"This method file performs the following steps:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:["A subset of profiles is selected, and a grid search is performed on ",(0,t.jsx)(i.code,{children:'"KEX_AB"'}),", ",(0,t.jsx)(i.code,{children:'"PB"'}),", and ",(0,t.jsx)(i.code,{children:'"DW_AB"'}),"."]}),"\n",(0,t.jsxs)(i.li,{children:["The parameters ",(0,t.jsx)(i.code,{children:'"KEX_AB"'}),", ",(0,t.jsx)(i.code,{children:'"PB"'}),", and ",(0,t.jsx)(i.code,{children:'"DW_AB"'})," are varied, using the same profile selection as in Step 1."]}),"\n",(0,t.jsxs)(i.li,{children:["All profiles are included, ",(0,t.jsx)(i.code,{children:'"KEX_AB"'})," and ",(0,t.jsx)(i.code,{children:'"PB"'})," are fixed, and a grid search is performed on ",(0,t.jsx)(i.code,{children:'"DW_AB"'}),"."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"DW_AB"'})," is varied."]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Results are saved in directories named according to each step."}),"\n",(0,t.jsx)(i.h2,{id:"setting-parameter-behavior",children:"Setting Parameter Behavior"}),"\n",(0,t.jsx)(i.p,{children:"Parameters can be set to vary, be fixed, or be constrained. You can adjust parameter behavior in each fitting step."}),"\n",(0,t.jsx)(i.h3,{id:"fit",children:(0,t.jsx)(i.code,{children:"FIT"})}),"\n",(0,t.jsxs)(i.p,{children:["Parameters in the ",(0,t.jsx)(i.code,{children:"FIT"})," list are varied during the fitting step. Parameters may be specified individually or as groups."]}),"\n",(0,t.jsx)(i.p,{children:"Example:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'FIT = [\n    "R2_A, NUC->G23N, B0->800.13MHz, T->23C",\n    "R1_A, B0->800.13MHz",\n    "DW_AB, NUC->N",\n    "R2_B",\n]\n'})}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"R2_A, NUC->G23N, B0->800.13MHz, T->23C"'})," specifies the R",(0,t.jsx)("sub",{children:"2"})," of the nitrogen nucleus in state A of Gly23 at 800.13 MHz and 23 \xbaC."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"R1_A, B0->800.13MHz"'})," includes all R\u2081 values for state A at 800.13 MHz."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"DW_AB, NUC->N"'})," applies to nitrogen chemical shift differences between states A and B."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"R2_B"'})," includes all R",(0,t.jsx)("sub",{children:"2"})," values for state B."]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"fix",children:(0,t.jsx)(i.code,{children:"FIX"})}),"\n",(0,t.jsxs)(i.p,{children:["Parameters in the ",(0,t.jsx)(i.code,{children:"FIX"})," list remain constant during the fitting step. The format matches that of the ",(0,t.jsx)(i.code,{children:"FIT"})," list."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'FIX = [\n    "R2_A, NUC->G23N, B0->800.13MHz, T->23C",\n    "R1_A, B0->800.13MHz",\n    "DW_AB, NUC->N",\n    "R2_B",\n]\n'})}),"\n",(0,t.jsx)(i.h3,{id:"constraints",children:(0,t.jsx)(i.code,{children:"CONSTRAINTS"})}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"CONSTRAINTS"})," list defines constraints on parameters using mathematical expressions of other parameters."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'CONSTRAINTS = [\n    "[R1_B] = 0.5 * [R1_A]",\n    "[R2_B, NUC->N] = [R2_A, NUC->N]",\n]\n'})}),"\n",(0,t.jsxs)(i.admonition,{title:"Parameter Precedence",type:"info",children:[(0,t.jsxs)(i.p,{children:["The settings in method files follow this order of precedence: ",(0,t.jsx)(i.code,{children:"CONSTRAINTS"})," -> ",(0,t.jsx)(i.code,{children:"FIX"})," -> ",(0,t.jsx)(i.code,{children:"FIT"}),". This means:"]}),(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Parameters in ",(0,t.jsx)(i.code,{children:"CONSTRAINTS"})," are initialized first."]}),"\n",(0,t.jsxs)(i.li,{children:["Parameters listed in ",(0,t.jsx)(i.code,{children:"FIX"})," will be held constant, even if also present in ",(0,t.jsx)(i.code,{children:"CONSTRAINTS"}),"."]}),"\n",(0,t.jsxs)(i.li,{children:["Parameters in ",(0,t.jsx)(i.code,{children:"FIT"})," are set to vary, taking precedence over both ",(0,t.jsx)(i.code,{children:"FIX"})," and ",(0,t.jsx)(i.code,{children:"CONSTRAINTS"})," settings."]}),"\n"]}),(0,t.jsxs)(i.p,{children:["For instance, if a parameter is both constrained (in ",(0,t.jsx)(i.code,{children:"CONSTRAINTS"}),") and fixed (in ",(0,t.jsx)(i.code,{children:"FIX"}),"), it will remain fixed, ignoring the constraint. Similarly, if a parameter is in both ",(0,t.jsx)(i.code,{children:"FIX"})," and ",(0,t.jsx)(i.code,{children:"FIT"}),", it will ultimately be set to vary."]})]}),"\n",(0,t.jsx)(i.h2,{id:"selecting-a-subset-of-profiles",children:"Selecting a Subset of Profiles"}),"\n",(0,t.jsx)(i.h3,{id:"include",children:(0,t.jsx)(i.code,{children:"INCLUDE"})}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"INCLUDE"})," key specifies residues for analysis in each fitting step. Residues can be specified by spin-system name (e.g., ",(0,t.jsx)(i.code,{children:'"G23N-H"'}),"), group name (e.g., ",(0,t.jsx)(i.code,{children:'"G23"'}),"), or residue number (e.g., ",(0,t.jsx)(i.code,{children:"23"}),"). The default value, ",(0,t.jsx)(i.code,{children:'"ALL"'})," (or ",(0,t.jsx)(i.code,{children:'"*"'}),"), includes all residues."]}),"\n",(0,t.jsxs)(i.admonition,{type:"note",children:[(0,t.jsx)(i.p,{children:"When using residue numbers only, provide a list of integers without quotes:"}),(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'INCLUDE = ["G2", "A4", "C5", "H6"]\nINCLUDE = [2, 4, 5, 6]\n'})})]}),"\n",(0,t.jsx)(i.h3,{id:"exclude",children:(0,t.jsx)(i.code,{children:"EXCLUDE"})}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"EXCLUDE"})," key excludes specific residues from analysis, using the same format as ",(0,t.jsx)(i.code,{children:"INCLUDE"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"running-a-grid-search",children:"Running a Grid Search"}),"\n",(0,t.jsxs)(i.p,{children:["ChemEx supports n-dimensional grid search with 1D and 2D plot outputs for visualizing \u03C7\xb2 values. Define grid search with the ",(0,t.jsx)(i.code,{children:"GRID"})," key in any fitting step."]}),"\n",(0,t.jsx)(i.p,{children:"Grid points are defined as:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Linear scale:","\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'"[PB] = lin(<min>, <max>, <nb of points>)"\n'})}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["Log scale:","\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'"[PB] = log(<min>, <max>, <nb of points>)"\n'})}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["Specific points:","\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'"[PB] = (<value1>, <value2>, ..., <valuen>)"\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Example:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'GRID = [\n    "[PB] = log(0.03, 0.1, 10)",\n    "[KEX_AB] = log(200.0, 1000.0, 10)",\n    "[DW_AB] = lin(0.0, 10.0, 10)",\n]\n'})}),"\n",(0,t.jsxs)(i.p,{children:["Results are stored in the ",(0,t.jsx)(i.code,{children:"grid.toml"})," file, with 1D and 2D plots generated. If more than two parameters are defined, sub-grids of interdependent parameters are evaluated, yielding 3D grids."]}),"\n",(0,t.jsx)(i.h2,{id:"estimating-parameter-uncertainty",children:"Estimating Parameter Uncertainty"}),"\n",(0,t.jsx)(i.p,{children:"ChemEx offers additional methods for estimating uncertainty, including Monte Carlo, bootstrap, and nucleus-specific bootstrap analyses."}),"\n",(0,t.jsx)(i.h3,{id:"monte-carlo-simulations",children:"Monte Carlo Simulations"}),"\n",(0,t.jsx)(i.p,{children:"In Monte Carlo simulations, the fit is run once, Gaussian noise is added to generated profiles, and fitting is repeated. After N simulations, the distribution of fitted parameters provides an uncertainty estimate."}),"\n",(0,t.jsx)(i.h3,{id:"bootstrap-analysis",children:"Bootstrap Analysis"}),"\n",(0,t.jsx)(i.p,{children:"Bootstrap analysis randomly resamples data points from each profile to create synthetic datasets of the same size, and then fits are repeated."}),"\n",(0,t.jsx)(i.h3,{id:"nucleus-specific-bootstrap-analysis",children:"Nucleus-Specific Bootstrap Analysis"}),"\n",(0,t.jsx)(i.p,{children:"In nucleus-specific bootstrap, profiles are resampled based on the associated nucleus, creating synthetic datasets. Profiles with fewer data points may yield datasets of varying sizes."}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsx)(i.p,{children:"Nucleus-specific bootstrap can create datasets of varying sizes, unlike standard bootstrap analysis."})}),"\n",(0,t.jsx)(i.h3,{id:"syntax",children:"Syntax"}),"\n",(0,t.jsxs)(i.p,{children:["Run these analyses at the end of any fitting step using the ",(0,t.jsx)(i.code,{children:"STATISTICS"})," key."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'[STEP1]\nSTATISTICS = {"MC"= 100}\n'})}),"\n",(0,t.jsx)(i.p,{children:"Available types:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"MC"'})," for Monte Carlo"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"BS"'})," for bootstrap"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'"BSN"'})," for nucleus-specific bootstrap"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"To perform multiple analyses:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-toml",children:'[STEP1]\nSTATISTICS = {"MC"= 100, "BS"= 100}\n'})}),"\n",(0,t.jsxs)(i.p,{children:["Outputs are stored in a file in the corresponding step directory. When data is unavailable (e.g., in nucleus-specific bootstrap), placeholders (",(0,t.jsx)(i.code,{children:'"--"'}),") are used."]})]})}function h(e={}){let{wrapper:i}={...(0,r.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},65:function(e,i,n){n.d(i,{Z:function(){return d},a:function(){return l}});var s=n(7294);let t={},r=s.createContext(t);function l(e){let i=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:i},e.children)}}}]);